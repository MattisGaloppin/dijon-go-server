<div class="player-list-container">
  <h3>Joueurs connectés</h3>
  <div class="player-list">
    <div *ngIf="connectedPlayers.length === 0">Aucun joueur connecté...</div>
    <div *ngFor="let player of connectedPlayers" 
         class="player-item" 
         (click)="selectPlayer(player)"
         [class.selected]="selectedPlayer === player">
      <span class="player-name">
        <img [src]="'https://localhost:7065/profile-pics/' + player" alt="{{ player }}'s avatar" class="player-avatar" />
        {{ player }} 
        <span class="unread-messages" *ngIf="getUnreadMessageCount(player) > 0">
          {{ getUnreadMessageCount(player) }}
        </span>
      </span>
      <div class="online-status"></div>
    </div>
  </div>

  <!-- Chat avec le joueur sélectionné -->
  <div *ngIf="selectedPlayer" class="chat-section">
    <div class="chat-header">
      Chat avec {{ selectedPlayer }}
      <button class="close-chat" (click)="closeChat()"><mat-icon>close</mat-icon></button>
    </div>
    <div class="chat-messages">
      <div *ngFor="let msg of messages" class="message" 
           [class.sent]="msg.sender === currentUser"
           [class.received]="msg.sender !== currentUser">
        <span class="message-content">{{ msg.content }}</span>
        <span class="message-time">{{ msg.timestamp | date:'HH:mm' }}</span>
      </div>
    </div>
    <div class="chat-input">
      <input [(ngModel)]="newMessage" 
             (keyup.enter)="sendMessage()"
             placeholder="Écrivez votre message...">
      <button (click)="sendMessage()">Envoyer</button>
    </div>
  </div>
</div>
